<h2>这是E-control命令速查表网站的源码，E-control项目暂不开源</h2>
<div align="center">
  <img width="100" height="100" src="https://img.icons8.com/metro/100/console.png" alt="console"/>
  <h1>E-control 远程控制系统</h1>
  <p>基于电子邮件的远程控制工具</p>
  
  ![Python](https://img.shields.io/badge/Python-3776AB?style=flat&logo=python&logoColor=white)
  ![Email](https://img.shields.io/badge/Email-D14836?style=flat&logo=gmail&logoColor=white)
  ![Windows](https://img.shields.io/badge/Windows-0078D6?style=flat&logo=windows&logoColor=white)
</div>

## 项目概述

这是一个基于电子邮件的远程控制系统，通过接收特定格式的邮件指令，实现对目标设备的远程控制和信息收集。系统采用模块化设计，支持命令执行、文件操作等功能。

## 系统架构

```
+------------------+      +------------------+      +------------------+
|                  |      |                  |      |                  |
|   邮件接收模块   | ---> |   命令解析模块    | ---> |   命令执行模块   |
|  (POP3客户端)    |      |  (解析器)        |      |  (多线程执行器)   |
|                  |      |                  |      |                  |
+------------------+      +--------+---------+      +--------+---------+
                                   |                         |
                                   v                         v
                      +---------------------+    +----------------------+
                      |                     |    |                      |
                      |    文件操作模块     |    |    系统信息收集模块   |
                      |  (文件/文件夹管理)  |    |   (设备信息/截图等)   |
                      |                     |    |                      |
                      +---------------------+    +----------------------+
                                     \                 /
                                      \               /
                                       v             v
                                  +----------------------+
                                  |                      |
                                  |    邮件发送模块      |
                                  |    (SMTP客户端)      |
                                  |                      |
                                  +------------------ ---+
```

## 执行流程

1. **初始化阶段**
   - 加载配置文件
   - 建立邮件服务器连接
   - 发送系统启动通知

2. **主循环**
   ```
   ┌─────────────────────────────────────────────────────┐
   │                                                     │
   │  1. 检查新邮件                                      │
   │     ↓                                               │
   │  2. 解析邮件内容                                    │
   │     ↓                                               │
   │  3. 验证命令格式                                    │
   │     ↓                                               │
   │  4. 执行相应操作                                    │
   │    ├─ 执行系统命令                                  │
   │    ├─ 文件操作                                      │
   │    └─ 打开网站                                      │
   │     ↓                                               │
   │  5. 发送执行结果                                    │
   │     ↓                                               │
   │  6. 等待指定间隔后继续循环                           │
   │                                                     │
   └─────────────────────────────────────────────────────┘
   ```

3. **命令处理流程**
   ```
   ┌───────────────┐    ┌───────────────┐    ┌────────────────┐
   │               │    │               │    │                │
   │  接收原始命令 │──> │  解析命令类型  │───>│  执行对应操作  │
   │  (字符串格式) │    │  (cmd+/其他)   │   │  (命令/文件/URL)│
   │               │    │               │    │                │
   └───────────────┘    └───────┬───────┘    └────────┬───────┘
                                │                      │
                                v                      v
                        ┌───────────────┐    ┌────────────────┐
                        │               │    │                │
                        │  命令格式错误 │    │  收集执行结果   │
                        │ (返回错误信息)│    │   (准备发送)    │
                        │               │    │                │
                        └───────────────┘    └────────┬───────┘
                                                      │
                                                      v
                                              ┌────────────────┐
                                              │                │
                                              │  发送执行结果  │
                                              │  (通过SMTP)    │
                                              │                │
                                              └────────────────┘
   ```

## 目前实现功能如下

### 1. 基础命令格式

#### 设备定向命令（需指定设备名）
- `to+设备名+cmd+命令` - 执行系统命令
- `to+设备名+website+网址` - 访问网站（无需加https://）
- `to+设备名+poweroff` - 关闭程序运行
- `to+设备名+file+list` - 列出桌面文件
- `to+设备名+file+文件名` - 发送桌面文件
- `to+设备名+file+文件夹名` - 列出文件夹内容
- `to+设备名+file+文件夹名+文件名` - 发送文件夹中的文件
- `to+设备名+a` - 快捷指令：显示错误弹窗
- `to+设备名+b` - 快捷指令：播放《Never Gonna Give You Up》
- `to+设备名+screen` - 发送当前屏幕截屏
- `to+设备名+remove` - 启动自毁程序

#### 广播命令（无需指定设备名）
- `cmd+命令` - 执行系统命令
- `website+网址` - 访问网站
- `poweroff` - 关闭程序运行
- `file+list` - 列出桌面文件
- `file+文件名` - 发送桌面文件
- `file+文件夹名` - 列出文件夹内容
- `file+文件夹名+文件名` - 发送文件夹中的文件
- `a` - 快捷指令：显示错误弹窗
- `b` - 快捷指令：播放《Never Gonna Give You Up》
- `screen` - 发送当前屏幕截屏
- `remove` - 启动自毁程序

## 使用说明与注意事项

### 命令使用说明
1. **命令格式**
   - 设备名中不能包含 `+` 符号
   - 命令区分大小写
   - 不支持命令嵌套

2. **权限说明**
   - 需要管理员权限的命令会自动触发UAC弹窗
   - 30秒内未确认将放弃执行
   - 低权限执行失败后会自动尝试管理员权限

3. **文件传输**
   - 支持通过邮件附件发送文件
   - 单个文件大小限制：20MB
   - 超出限制将放弃执行

4. **认证信息**
   - 使用POP3与SMTP认证
   - 授权码有效期为180天
   - 过期后需更新认证信息
